<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Steepest-ascent methods for response surfaces — steepest • rsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Steepest-ascent methods for response surfaces — steepest"><meta name="description" content="These functions provide the path of steepest ascent (or descent)
  for a fitted response surface produced by rsm."><meta property="og:description" content="These functions provide the path of steepest ascent (or descent)
  for a fitted response surface produced by rsm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/article-JSS.html">Response-Surface Methods in R, Using rsm</a></li>
    <li><a class="dropdown-item" href="../articles/illus.html">Response-surface illustration</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Surface Plots in the rsm Package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/rvlenth/rsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Steepest-ascent methods for response surfaces</h1>

      <div class="d-none name"><code>steepest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions provide the path of steepest ascent (or descent)
  for a fitted response surface produced by <code><a href="rsm.html">rsm</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">steepest</span> <span class="op">(</span><span class="va">object</span>, dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>, descent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">canonical.path</span><span class="op">(</span><span class="va">object</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">descent</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">b</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>               dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, descent <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code><a href="rsm.html">rsm</a></code> object to be analyzed.</p></dd>

  <dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Vector of desired distances along the path of steepest ascent or descent.
  In <code>steepest</code>, these must all be non-negative; in <code>canonical.path</code>,
  you may want both positive and negative values, which specify opposite directions from the stationary point.</p></dd>

  <dt id="arg-descent">descent<a class="anchor" aria-label="anchor" href="#arg-descent"></a></dt>
<dd><p>Set this to <code>TRUE</code> to obtain the path of steepest descent, or
    <code>FALSE</code> to obtain the path of steepest ascent.  This value is ignored in
    <code>canonical.path</code> if <code>which</code> is specified.</p></dd>

  <dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>Which canonical direction (eigenvector) to use.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments passed to <code><a href="rsm.html">canonical</a></code>.
    Currently this includes only <code>threshold</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>steepest</code> returns the linear path of steepest ascent for first-order models, or a path obtained by ridge analysis (see Draper 1963) for second-order models.  In either case, the path begins at the origin.</p>
<p><code>canonical.path</code> applies only to second-order models (at least a <code>TWI</code> term present).  It determines a linear path along one of the canonical variables, originating at the stationary point (not the origin).  We need to specify which canonical variable to use.
  The eigenvalues obtained in the canaonical analysis are always in decreasing order, so the first canonical direction will be the path of steepest ascent (or slowest descent, if all eigenvalues are negative) from the stationary point, and the last one will be the path of steepest descent (or slowest ascent, if all eigenvalues are positive).  These are the defaults for <code>which</code> when <code>descent=FALSE</code> and <code>descent=TRUE</code> respectively.</p>
<p>All eigenvalues less (in absolute value than) <code>threshold</code> are taken to be zero. Increasing this threshold may bring the stationary point, and hence the canonical path, much closer to the design center, and thus less extrapolation.</p>
<p>With either function, the path in uncoded units depends on how the data are coded.  Accordingly, it is important to code the predictor variables appropriately before fitting the response-surface model.  See <code><a href="coded.data.html">coded.data</a></code> and its relatives for more information.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> of points along the path of steepest ascent (or descent).
  For <code>steepest</code>, this path originates from the center of the experiment; for <code>canonical.path</code>,
  it starts at the stationary point.
  If coding information is available, the data frame also includes the uncoded values of the variables.</p>
<p>For first-order response surfaces, only <code>steepest</code> may be used; the path is linear in that case.
  For second-order surfaces, <code>steepest</code> uses ridge analysis, and the path may be curved.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Draper, NR (1963), “Ridge analysis of response surfaces”,
  <em>Technometrics</em>, 5, 469–479.</p>
<p>Lenth RV (2009). “Response-Surface Methods in R, Using rsm”,
  <em>Journal of Statistical Software</em>, 32(7), 1–17.
  <a href="https://doi.org/10.18637/jss.v032.i07" class="external-link">doi:10.18637/jss.v032.i07</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Russell V. Lenth</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Take careful note of the fitted values along the outputted path (labeled <code>yhat</code>).  For example, if the stationary point is a maximum
  (all eigenvalues negative), the fitted values from <code>steepest</code> will increase as far as the stationary point, then they will decrease as we proceed along what is now the path of slowest descent.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rsm.html">rsm</a></code>, <code><a href="coded.data.html">coded.data</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/rsm">rsm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">heli.rsm</span> <span class="op">=</span> <span class="fu"><a href="rsm.html">rsm</a></span> <span class="op">(</span><span class="va">ave</span> <span class="op">~</span> <span class="va">block</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">heli</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">steepest</span><span class="op">(</span><span class="va">heli.rsm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Path of steepest ascent from ridge analysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    dist     x1    x2    x3     x4 |       A       R       W      L |    yhat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0  0.000 0.000 0.000  0.000 | 12.4000 2.52000 1.25000 2.0000 | 372.800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.5 -0.127 0.288 0.116 -0.371 | 12.3238 2.59488 1.27900 1.8145 | 377.106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.0 -0.351 0.538 0.312 -0.700 | 12.1894 2.65988 1.32800 1.6500 | 382.675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1.5 -0.595 0.775 0.526 -1.009 | 12.0430 2.72150 1.38150 1.4955 | 389.783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   2.0 -0.846 1.007 0.745 -1.309 | 11.8924 2.78182 1.43625 1.3455 | 398.485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2.5 -1.101 1.237 0.966 -1.605 | 11.7394 2.84162 1.49150 1.1975 | 408.819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   3.0 -1.356 1.465 1.189 -1.897 | 11.5864 2.90090 1.54725 1.0515 | 420.740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   3.5 -1.613 1.693 1.413 -2.188 | 11.4322 2.96018 1.60325 0.9060 | 434.322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   4.0 -1.870 1.920 1.637 -2.477 | 11.2780 3.01920 1.65925 0.7615 | 449.497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  4.5 -2.127 2.147 1.862 -2.766 | 11.1238 3.07822 1.71550 0.6170 | 466.323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  5.0 -2.385 2.373 2.086 -3.054 | 10.9690 3.13698 1.77150 0.4730 | 484.750</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">canonical.path</span><span class="op">(</span><span class="va">heli.rsm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    dist     x1     x2     x3     x4 |       A       R       W      L |    yhat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -5.0 -1.728  1.921  1.419 -2.967 | 11.3632 3.01946 1.60475 0.5165 | 453.627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -4.5 -1.469  1.696  1.193 -2.682 | 11.5186 2.96096 1.54825 0.6590 | 438.150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -4.0 -1.210  1.471  0.967 -2.397 | 11.6740 2.90246 1.49175 0.8015 | 424.302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -3.5 -0.951  1.246  0.742 -2.112 | 11.8294 2.84396 1.43550 0.9440 | 412.094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -3.0 -0.692  1.021  0.516 -1.827 | 11.9848 2.78546 1.37900 1.0865 | 401.504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -2.5 -0.434  0.795  0.290 -1.541 | 12.1396 2.72670 1.32250 1.2295 | 392.534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -2.0 -0.175  0.570  0.064 -1.256 | 12.2950 2.66820 1.26600 1.3720 | 385.203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -1.5  0.084  0.345 -0.162 -0.971 | 12.4504 2.60970 1.20950 1.5145 | 379.502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  -1.0  0.343  0.120 -0.388 -0.686 | 12.6058 2.55120 1.15300 1.6570 | 375.429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -0.5  0.602 -0.105 -0.614 -0.401 | 12.7612 2.49270 1.09650 1.7995 | 372.986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  0.0  0.861 -0.331 -0.839 -0.116 | 12.9166 2.43394 1.04025 1.9420 | 372.172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  0.5  1.120 -0.556 -1.065  0.169 | 13.0720 2.37544 0.98375 2.0845 | 372.987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  1.0  1.378 -0.781 -1.291  0.454 | 13.2268 2.31694 0.92725 2.2270 | 375.428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  1.5  1.637 -1.006 -1.517  0.739 | 13.3822 2.25844 0.87075 2.3695 | 379.499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  2.0  1.896 -1.232 -1.743  1.024 | 13.5376 2.19968 0.81425 2.5120 | 385.206</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  2.5  2.155 -1.457 -1.969  1.309 | 13.6930 2.14118 0.75775 2.6545 | 392.538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  3.0  2.414 -1.682 -2.195  1.594 | 13.8484 2.08268 0.70125 2.7970 | 401.498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  3.5  2.673 -1.907 -2.421  1.879 | 14.0038 2.02418 0.64475 2.9395 | 412.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  4.0  2.932 -2.132 -2.646  2.164 | 14.1592 1.96568 0.58850 3.0820 | 424.295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  4.5  3.190 -2.358 -2.872  2.449 | 14.3140 1.90692 0.53200 3.2245 | 438.140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  5.0  3.449 -2.583 -3.098  2.734 | 14.4694 1.84842 0.47550 3.3670 | 453.615</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

