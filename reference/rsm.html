<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit a linear model with a response-surface component,
  and produce appropriate analyses and summaries."><title>Response-surface regression — rsm • rsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Response-surface regression — rsm"><meta property="og:description" content="Fit a linear model with a response-surface component,
  and produce appropriate analyses and summaries."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/article-JSS.html">Response-Surface Methods in R, Using rsm</a>
    <a class="dropdown-item" href="../articles/illus.html">Response-surface illustration</a>
    <a class="dropdown-item" href="../articles/plots.html">Surface Plots in the rsm Package</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://github.com/rvlenth/rsm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Response-surface regression</h1>
      
      <div class="d-none name"><code>rsm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a linear model with a response-surface component,
  and produce appropriate analyses and summaries.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rsm</span> <span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rsm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">p.adjust.methods</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="co"># S3 method for summary.rsm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for rsm</span></span>
<span><span class="fu"><a href="coded.data.html">codings</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loftest</span> <span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">canonical</span> <span class="op">(</span><span class="va">object</span>, threshold <span class="op">=</span> <span class="fl">0.1</span><span class="op">*</span><span class="va">max.eigen</span><span class="op">)</span></span>
<span><span class="fu">xs</span> <span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Formula to pass to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>. 
  The model must include at least one <code><a href="FO.html">FO()</a></code>, <code><a href="FO.html">SO()</a></code>, <code><a href="FO.html">TWI()</a></code>, or <code><a href="FO.html">PQ()</a></code> term to
  define the response-surface portion of the model.</p></dd>

  <dt>data</dt>
<dd><p><code>data</code> argument to pass to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p></dd>

  <dt>...</dt>
<dd><p>In <code>rsm</code>, arguments that are passed to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, 
    <code><a href="https://rdrr.io/r/stats/summary.lm.html" class="external-link">summary.lm</a></code>, or <code>canonical</code>, as appropriate.
  In <code>summary</code>, and <code>print</code>, additional arguments 
  are passed to their generic methods.</p></dd>


  <dt>object</dt>
<dd><p>An object of class <code>rsm</code></p></dd>

  <dt>adjust</dt>
<dd><p>Adjustment to apply to the P values in the coefficient matrix, chosen from among the available <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code> methods in the <span class="pkg">stats</span> package. The default is <code>"none"</code>.</p></dd>

  <dt>threshold</dt>
<dd><p>Threshold for canonical analysis -- see "Canonical analysis" below.</p></dd>

  <dt>x</dt>
<dd><p>An object produced by <code>summary</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In <code>rsm</code>, the model formula must contain at least an <code>FO</code> term; optionally, you can add
  one or more <code><a href="FO.html">TWI()</a></code> terms and/or a <code><a href="FO.html">PQ()</a></code> term. All variables that appear
  in <code>TWI</code> or <code>PQ</code> <em>must</em> be included in <code>FO</code>.
  For convenience, specifying <code><a href="FO.html">SO()</a></code> is the same as including <code><a href="FO.html">FO()</a></code>, <code><a href="FO.html">TWI()</a></code>, and <code><a href="FO.html">PQ()</a></code>,
  and is the safe, preferred way of specifying a full second-order model.</p>  
<p>The variables in <code>FO</code> comprise the variables to consider in response-surface methods. They need not all appear in <code>TWI</code> and <code>PQ</code> terms; and more than one <code>TWI</code> term is allowed. For example, the following two model formulas are equivalent:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="va">resp</span> <span class="op">~</span> <span class="va">Oper</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">FO</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,<span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">TWI</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,<span class="va">x3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">TWI</a></span><span class="op">(</span><span class="va">x2</span>,<span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">PQ</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span></span>
<span><span class="va">resp</span> <span class="op">~</span> <span class="va">Oper</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">FO</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,<span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">TWI</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="op">~</span><span class="va">x1</span><span class="op">*</span><span class="va">x2</span><span class="op">*</span><span class="va">x3</span> <span class="op">+</span> <span class="va">x2</span><span class="op">*</span><span class="va">x3</span><span class="op">*</span><span class="va">x4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/FO.html">PQ</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x3</span>,<span class="va">x4</span><span class="op">)</span></span></code></pre></div><p>The first version, however, creates duplicate <code>x2:x3</code> terms -- which <code>rsm</code> can handle but there may be warning messages if it is subsequently used for predictions or plotted in <code><a href="contour.lm.html">contour.lm</a></code>.</p>  
<p>In <code>summary.rsm</code>, any <code>...</code> arguments are passed to <code>summary.lm</code>, except for <code>threshold</code>, which is passed to <code>canonical</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p></p>
<p><code>rsm</code> returns an <code>rsm</code> object, which is a <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> object with 
  additional members as follows:</p>
<dl><dt>order</dt>
<dd><p>The order of the model: 1 for first-order, 1.5 for first-order plus interactions, 
     or 2 for a model that contains square terms.</p></dd>

    <dt>b</dt>
<dd><p>The first-order response-surface coefficients.</p></dd>

    <dt>B</dt>
<dd><p>The matrix of second-order response-surface coefficients, if present.</p></dd>

    <dt>labels</dt>
<dd><p>Labels for the response-surface terms.  These make the summary much more readable.</p></dd>

    <dt>coding</dt>
<dd><p>Coding formulas, if provided in the <code>codings</code> argument or
      if the <code>data</code> argument passed to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> is a <code><a href="coded.data.html">coded.data</a></code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="summary-and-print-methods">Summary and print methods<a class="anchor" aria-label="anchor" href="#summary-and-print-methods"></a></h2>
    <p>The <code>print</code> method for <code>rsm</code> objects just shows the call and the regression
  coefficints.</p>
<p>The <code>summary</code>method for <code>rsm</code> objects returns an object of class
  <code>summary.rsm</code>, which is an extension of the <code>summary.lm</code>
  class with these additional list elements:</p><dl><dt>sa</dt>
<dd><p>Unit-length vector of the path of steepest ascent
      (first-order models only).</p></dd>

    <dt>canonical</dt>
<dd><p>Canonical analysis (second-order models only) from <code>canonical</code></p></dd>

    <dt>lof</dt>
<dd><p>ANOVA table including lack-of-fit test.</p></dd>

    <dt>coding</dt>
<dd><p>Coding formulas in parent <code>rsm</code> object.</p></dd>

  Its print method shows the regression summary,
  followed by an ANOVA and lack-of-fit test.  
  For first-order models, it shows the direction of 
  steepest ascent (see <a href="steepest.html">steepest</a>), and for second-order models, it shows the canonical analysis of the
  response surface.  

</dl></div>
    <div class="section level2">
    <h2 id="canonical-analysis-and-stationary-point">Canonical analysis and stationary point<a class="anchor" aria-label="anchor" href="#canonical-analysis-and-stationary-point"></a></h2>
    <p><code>canonical</code> returns a list with elements <code>xs</code>, the stationary point, and <code>eigen</code>, the eigenanalysis of the matrix <b>B</b> of second-order coefficients. Any eigenvalues less than <code>threshold</code> are taken to be zero, and a message is displayed.
If this happens, the stationary point is determined using only the surviving eigenvectors,
and stationary ridges or valleys are assumed to exist in their 
corresponding canonical directions. The default threshold is one tenth
of the maximum eigenvalue, internally named <code>max.eigen</code>.
Setting a small <code>threshold</code> may move the stationary point much farther from the origin.</p>
<p>When uncoded data are used, the canonical analysis and stationary point are not
very meaningful and those results should probably be ignored.
See <samp>vignette("rsm")</samp> for more details.</p>  
<p>The function <code>xs</code> returns just the stationary point.</p>
    </div>
    <div class="section level2">
    <h2 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a></h2>
    <p><code>loftest</code> returns an <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></code> object that tests the fitted model against a model 
  that interpolates the means of the response-surface-variable combinations.</p>
<p><code>codings</code> returns a <code>list</code> of coding formulas if the model was fitted to 
  <code><a href="coded.data.html">coded.data</a></code>, or <code>NULL</code> otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="emmeans-support"><span class="pkg">emmeans</span> support<a class="anchor" aria-label="anchor" href="#emmeans-support"></a></h2>
    <p>Support is provided for the <span class="pkg">emmeans</span> package: its <code><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans</a></code> and related functions work with special provisions for models fitted to coded data. The optional <code>mode</code> argument can have values of <code>"asis"</code> (the default), <code>"coded"</code>, or <code>"decoded"</code>. The first two are equivalent and simply return LS means based on the original model formula and the variables therein (raw or coded), without any conversion. When coded data were used and the user specifies <code>mode = "decoded"</code>, the user must specify results in terms of the decoded variables rather than the coded ones. See the illustration in the Examples section.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lenth RV (2009) ``Response-Surface Methods in R, Using rsm'', 
  <em>Journal of Statistical Software</em>, 32(7), 1--17. 
  <a href="https://doi.org/10.18637/jss.v032.i07" class="external-link">doi:10.18637/jss.v032.i07</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Russell V. Lenth</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="FO.html">FO</a></code>, <code><a href="FO.html">SO</a></code>,
  <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code>summary</code>, <code><a href="coded.data.html">coded.data</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvlenth/rsm">rsm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CR</span> <span class="op">&lt;-</span> <span class="fu"><a href="coded.data.html">coded.data</a></span> <span class="op">(</span><span class="va">ChemReact</span>, <span class="va">x1</span><span class="op">~</span><span class="op">(</span><span class="va">Time</span><span class="op">-</span><span class="fl">85</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>, <span class="va">x2</span><span class="op">~</span><span class="op">(</span><span class="va">Temp</span><span class="op">-</span><span class="fl">175</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### 1st-order model, using only the first block</span></span></span>
<span class="r-in"><span><span class="va">CR.rs1</span> <span class="op">&lt;-</span> <span class="fu">rsm</span> <span class="op">(</span><span class="va">Yield</span> <span class="op">~</span> <span class="fu"><a href="FO.html">FO</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">CR</span>, subset<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CR.rs1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rsm(formula = Yield ~ FO(x1, x2), data = CR, subset = 1:7)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error  t value  Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 82.81429    0.54719 151.3456 1.143e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           0.87500    0.72386   1.2088    0.2933    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           0.62500    0.72386   0.8634    0.4366    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.3555,	Adjusted R-squared:  0.0333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 1.103 on 2 and 4 DF,  p-value: 0.4153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Yield</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df Sum Sq Mean Sq F value  Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FO(x1, x2)   2 4.6250  2.3125  1.1033 0.41534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals    4 8.3836  2.0959                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lack of fit  2 8.2969  4.1485 95.7335 0.01034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pure error   2 0.0867  0.0433                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Direction of steepest ascent (at radius 1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        x1        x2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8137335 0.5812382 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding increment in original units:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Time     Temp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.068667 2.906191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### 2nd-order model, using both blocks</span></span></span>
<span class="r-in"><span><span class="va">CR.rs2</span> <span class="op">&lt;-</span> <span class="fu">rsm</span> <span class="op">(</span><span class="va">Yield</span> <span class="op">~</span> <span class="va">Block</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">CR</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">CR.rs2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rsm(formula = Yield ~ Block + SO(x1, x2), data = CR)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error  t value  Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 84.095427   0.079631 1056.067 &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BlockB2     -4.457530   0.087226  -51.103 2.877e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1           0.932541   0.057699   16.162 8.444e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2           0.577712   0.057699   10.012 2.122e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1:x2        0.125000   0.081592    1.532    0.1694    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1^2        -1.308555   0.060064  -21.786 1.083e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2^2        -0.933442   0.060064  -15.541 1.104e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9981,	Adjusted R-squared:  0.9964 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 607.2 on 6 and 7 DF,  p-value: 3.811e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Variance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response: Yield</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Df Sum Sq Mean Sq   F value    Pr(&gt;F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Block        1 69.531  69.531 2611.0950 2.879e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FO(x1, x2)   2  9.626   4.813  180.7341 9.450e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TWI(x1, x2)  1  0.063   0.063    2.3470    0.1694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PQ(x1, x2)   2 17.791   8.896  334.0539 1.135e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals    7  0.186   0.027                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lack of fit  3  0.053   0.018    0.5307    0.6851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pure error   4  0.133   0.033                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stationary point of response surface:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        x1        x2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3722954 0.3343802 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stationary point in original units:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Time      Temp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  86.86148 176.67190 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenanalysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eigen() decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.9233027 -1.3186949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x1 -0.1601375 -0.9870947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 -0.9870947  0.1601375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example of a rising-ridge situation from Montgomery et al, Table 6.2</span></span></span>
<span class="r-in"><span><span class="va">RRex</span> <span class="op">&lt;-</span> <span class="fu"><a href="ccd.html">ccd</a></span><span class="op">(</span><span class="va">Response</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, n0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="st">"face"</span>, </span></span>
<span class="r-in"><span>            randomize <span class="op">=</span> <span class="cn">FALSE</span>, oneblock <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RRex</span><span class="op">$</span><span class="va">Response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52.3</span>, <span class="fl">5.3</span>, <span class="fl">46.7</span>, <span class="fl">44.2</span>, <span class="fl">58.5</span>, <span class="fl">33.5</span>, <span class="fl">32.8</span>, <span class="fl">49.2</span>, <span class="fl">49.3</span>, <span class="fl">50.2</span>, <span class="fl">51.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RRex.rsm</span> <span class="op">&lt;-</span> <span class="fu">rsm</span><span class="op">(</span><span class="va">Response</span> <span class="op">~</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">RRex</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">canonical</span><span class="op">(</span><span class="va">RRex.rsm</span><span class="op">)</span>  <span class="co"># rising ridge is detected</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Near-stationary-ridge situation detected -- stationary point altered</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Change 'threshold' if this is not what you intend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          A          B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2928046  0.4526154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eigen() decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   0.00000 -12.70637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A -0.8396245 -0.5431673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B -0.5431673  0.8396245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">canonical</span><span class="op">(</span><span class="va">RRex.rsm</span>, threshold <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>  <span class="co"># xs is far outside of the experimental region</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A         B </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -5.176505 -2.706733 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $eigen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> eigen() decomposition</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  -0.509419 -12.706370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $vectors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A -0.8396245 -0.5431673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B -0.5431673  0.8396245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Illustration of emmeans support</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">CR.rs2</span>, <span class="op">~</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span>, mode <span class="op">=</span> <span class="st">"coded"</span>, </span></span>
<span class="r-in"><span>        at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co"># The following will yield the same results, but based on the decoded data</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">CR.rs2</span>, <span class="op">~</span> <span class="va">Time</span> <span class="op">*</span> <span class="va">Temp</span>, mode <span class="op">=</span> <span class="st">"decoded"</span>, </span></span>
<span class="r-in"><span>        at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">85</span>, <span class="fl">90</span><span class="op">)</span>, Temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">165</span>, <span class="fl">185</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

