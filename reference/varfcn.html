<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Display the scaled variance function for a design — varfcn • rsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Display the scaled variance function for a design — varfcn"><meta name="description" content="This function computes the scaled variance function for a design, based on a
    specified model. Options include plotting separate curves for each of several
    directions from the center, or a contour plot for two of the design factors."><meta property="og:description" content="This function computes the scaled variance function for a design, based on a
    specified model. Options include plotting separate curves for each of several
    directions from the center, or a contour plot for two of the design factors."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.10.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/article-JSS.html">Response-Surface Methods in R, Using rsm</a></li>
    <li><a class="dropdown-item" href="../articles/illus.html">Response-surface illustration</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Surface Plots in the rsm Package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/rvlenth/rsm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Display the scaled variance function for a design</h1>

      <div class="d-none name"><code>varfcn.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the scaled variance function for a design, based on a
    specified model. Options include plotting separate curves for each of several
    directions from the center, or a contour plot for two of the design factors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">varfcn</span><span class="op">(</span><span class="va">design</span>, <span class="va">formula</span>, dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="va">vectors</span>, contour <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>       plot <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">main</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>A <code>data.frame</code> or <code>coded.data</code> object</p></dd>

  <dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>The model formula for which to compute the variance function</p></dd>

  <dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Vector of distances from the origin at which to compute the scaled variance</p></dd>

  <dt id="arg-vectors">vectors<a class="anchor" aria-label="anchor" href="#arg-vectors"></a></dt>
<dd><p>A <code>data.frame</code> of design variables. Each nonzero row specifies a direction in which to calculate the scaled variance.</p></dd>

  <dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>A logical variable. If <code>TRUE</code>, a contour plot is produced; if <code>FALSE</code>, curves are plotted for each direction in <code>vectors</code>.</p></dd>

  <dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>A logical variable. If <code>TRUE</code>, a plot is produced.</p></dd>

  <dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Title for the plot. The default is constructed based on the name of <code>design</code> and <code>formula</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code> or <code><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></code> functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The scaled prediction variance at a particular design point is the variance of the predicted value, multiplied by the sample size <em>N</em>, and divided by the error variance. (See, for example, Montgomery <em>et al.</em>, Section 8.2.1). It depends on the design point, but for a symmetric design, it depends only on the distance from the origin and the direction. This function provides a simple way to examine the variance function directly. (There are other more
sophisticated methods available that integrate-out the direction, for example in the <span class="pkg">vdg</span> package.</p>
<p>If <code>vectors</code> is not specified and <code>contour==FALSE</code>, the function generates default directions along one axis, and on a diagonal through a corner in each dimension. For example, with four design variables, the default directions are (1,0,0,0), (1,1,0,0), (1,1,1,0), and (1,1,1,1). The graph produced shows how the scaled variance changes along each of these vectors, for the distances provided. In a rotatable design, these curves will all be the same.</p>
<p>When <code>countour==TRUE</code>, only the ordering of columns in <code>vectors</code> matters. A grid is constructed over the distance range for the first two variables in <code>vectors</code>. The design points are also plotted for reference, with different symbol sizes depending on replications. When there are more than two response-surface predictors, the contour plot may be misleading, as it does not display what happens as one simultaneously varies three or more variables.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function invisibly returns a <code>data.frame</code> containing the data that was (or would have been) plotted.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Myers, RH Montgomery DC, and Anderson-Cook CM (2009)
<em>Response Surface Methodology</em> (3rd ed.), Wiley.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Russell V. Lenth</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">des</span> <span class="op">=</span> <span class="fu"><a href="ccd.html">ccd</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, alpha <span class="op">=</span> <span class="fl">1.5</span>, block <span class="op">=</span> <span class="va">Phase</span> <span class="op">~</span> <span class="va">x1</span><span class="op">*</span><span class="va">x2</span><span class="op">*</span><span class="va">x3</span>, randomize<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">varfcn</span><span class="op">(</span><span class="va">des</span>, <span class="op">~</span> <span class="va">Phase</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varfcn-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  <span class="fu">varfcn</span><span class="op">(</span><span class="va">des</span>, <span class="op">~</span> <span class="va">Phase</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, contour<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varfcn-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># 10 random directions</span></span></span>
<span class="r-in"><span>  <span class="va">dirs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">varfcn</span><span class="op">(</span><span class="va">des</span>, <span class="op">~</span> <span class="va">Phase</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, vectors <span class="op">=</span> <span class="va">dirs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varfcn-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># exclude some points to make it more interesting</span></span></span>
<span class="r-in"><span>  <span class="va">lost</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">varfcn</span><span class="op">(</span><span class="va">des</span><span class="op">[</span><span class="op">-</span><span class="va">lost</span>, <span class="op">]</span>, <span class="op">~</span> <span class="va">Phase</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, contour<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varfcn-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># different plot due to order of columns</span></span></span>
<span class="r-in"><span>  <span class="fu">varfcn</span><span class="op">(</span><span class="va">des</span><span class="op">[</span><span class="op">-</span><span class="va">lost</span>, <span class="op">]</span>, <span class="op">~</span> <span class="va">Phase</span> <span class="op">+</span> <span class="fu"><a href="FO.html">SO</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span>, vectors <span class="op">=</span> <span class="va">dirs</span>, contour<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="varfcn-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

